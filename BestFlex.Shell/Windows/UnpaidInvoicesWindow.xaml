<Window x:Class="BestFlex.Shell.Windows.UnpaidInvoicesWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Unpaid Invoices" Height="560" Width="880"
        WindowStartupLocation="CenterOwner">
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="8"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <DockPanel Grid.Row="0" LastChildFill="False">
            
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="Top" VerticalAlignment="Center" Margin="0,0,6,0"/>
                <ComboBox x:Name="cmbTop" Width="90" SelectedIndex="1">
                    <ComboBoxItem Content="5"/>
                    <ComboBoxItem Content="10"/>
                    <ComboBoxItem Content="20"/>
                    <ComboBoxItem Content="50"/>
                    <ComboBoxItem Content="100"/>
                </ComboBox>
                <Button Content="Open Statement" Width="130" Margin="8,0,0,0" Click="OpenStatement_Click"/>

                <Button Content="Refresh" Margin="8,0,0,0" Click="Refresh_Click"/>
            </StackPanel>
            <TextBlock x:Name="txtSummary" DockPanel.Dock="Right" VerticalAlignment="Center"
                       Text="{Binding TotalOutstanding, StringFormat={}{0:N2}}"/>
        </DockPanel>

        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="8"/>
                <ColumnDefinition Width="2*"/>
            </Grid.ColumnDefinitions>

            <!-- Top debtors -->
            <DataGrid x:Name="gridCustomers" AutoGenerateColumns="False" CanUserAddRows="False" IsReadOnly="True"
                      HeadersVisibility="Column" RowHeight="34" GridLinesVisibility="Horizontal"
                      AlternatingRowBackground="#FAFAFA"
                      SelectionChanged="gridCustomers_SelectionChanged"
                      ItemsSource="{Binding Items}">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Customer" Binding="{Binding CustomerName}" Width="*"/>
                    <DataGridTextColumn Header="Invoices" Binding="{Binding InvoiceCount}" Width="100"/>
                    <DataGridTextColumn Header="Amount" Binding="{Binding Amount, StringFormat={}{0:N2}}" Width="140"/>
                </DataGrid.Columns>
            </DataGrid>

            <!-- Spacer -->
            <GridSplitter Grid.Column="1" Width="8" HorizontalAlignment="Stretch" Background="#E5E7EB" />

            <!-- Invoices for selected customer -->
            <DataGrid Grid.Column="2" x:Name="gridInvoices" AutoGenerateColumns="False" CanUserAddRows="False" IsReadOnly="True"
                      HeadersVisibility="Column" RowHeight="34" GridLinesVisibility="Horizontal"
                      AlternatingRowBackground="#FAFAFA">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Invoice #" Binding="{Binding InvoiceNo}" Width="160"/>
                    <DataGridTextColumn Header="Date" Binding="{Binding IssuedAt, StringFormat={}{0:yyyy-MM-dd HH:mm}}" Width="180"/>
                    <DataGridTextColumn Header="Amount" Binding="{Binding Amount, StringFormat={}{0:N2}}" Width="140"/>
                    <DataGridTextColumn Header="Currency" Binding="{Binding Currency}" Width="100"/>
                </DataGrid.Columns>
            </DataGrid>
        </Grid>
    </Grid>
</Window>
